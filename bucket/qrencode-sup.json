{
    "version": "4.1.1-2_12.0.0.r423.g8bcd5fc1a-1_1.6.44-1_1.3.1-1",
    "description": "Encode input data in a QR Code symbol",
    "homepage": "https://fukuchi.org/works/qrencode/",
    "license": "LGPL-2.1-only",
    "architecture": {
        "64bit": {
            "url": [
                "https://mirror.msys2.org/mingw/mingw64/mingw-w64-x86_64-qrencode-4.1.1-2-any.pkg.tar.zst",
                "https://mirror.msys2.org/mingw/mingw64/mingw-w64-x86_64-libwinpthread-git-12.0.0.r423.g8bcd5fc1a-1-any.pkg.tar.zst",
                "https://mirror.msys2.org/mingw/mingw64/mingw-w64-x86_64-libpng-1.6.44-1-any.pkg.tar.zst",
                "https://mirror.msys2.org/mingw/mingw64/mingw-w64-x86_64-zlib-1.3.1-1-any.pkg.tar.zst"
            ],
            "hash": [
                "d6e9664075934140c19a34c1bf53c67b69909e7feef97ba5cb7ddbe850312d81",
                "2fd173acd8276a465d7cc5112947258c8e36542a25036861b56e76a134ac8aa7",
                "9f731bce4478acc3e5f05ff6a43197f212f7909f55b65dd6feb92d17540725d5",
                "ca04caafd73e15de216502d53038406e79d29b20c47d9a409e9b2d12858105f0"
            ]
        },
        "32bit": {
            "url": [
                "https://mirror.msys2.org/mingw/mingw32/mingw-w64-i686-qrencode-4.1.1-2-any.pkg.tar.zst",
                "https://mirror.msys2.org/mingw/mingw32/mingw-w64-i686-libwinpthread-git-12.0.0.r423.g8bcd5fc1a-1-any.pkg.tar.zst",
                "https://mirror.msys2.org/mingw/mingw32/mingw-w64-i686-libpng-1.6.44-1-any.pkg.tar.zst",
                "https://mirror.msys2.org/mingw/mingw32/mingw-w64-i686-zlib-1.3.1-1-any.pkg.tar.zst"
            ],
            "hash": [
                "fdec31c2c494ec025daff32c60db7a10f31ffbfb6348249fbb3c52059dab0786",
                "f4b1e39d0bd64d935daca5bc8e6d2e8c03413a2ab2e8bec4dc335efcbcb62463",
                "8bd9ae039c7913627e456918ba1042cb1e97f2df3524a791a92bdb938df56f39",
                "e1a5c74f5056e147fa0f48ce5f7b99bbf1dc67a4c7b60d0ffbb3ab1594a74e7b"
            ]
        }
    },
    "pre_install": [
        "movedir \"$dir\\$(if ($arch = '64bit') {'mingw64'} else {'mingw32'})\" \"$dir\" | Out-Null",
        "$keep_files = @(\"$dir\\bin\\qrencode.exe\",",
        "                \"$dir\\bin\\libqrencode.dll\",",
        "                \"$dir\\bin\\libwinpthread-1.dll\",",
        "                \"$dir\\bin\\libpng16-16.dll\",",
        "                \"$dir\\bin\\zlib1.dll\",",
        "                \"$dir\\share\\licenses\\qrencode\\COPYING\",",
        "                \"$dir\\share\\man\\man1\\qrencode.1.gz\")",
        "",
        "Get-ChildItem \"$dir\" -Recurse                 |",
        "    Select-Object -ExpandProperty FullName      |",
        "    Where-Object {$keep_files -notcontains $_ } |",
        "    Sort-Object Length -Descending              |",
        "    ForEach-Object { if ((Test-Path $_ -Type Container) -and (Get-ChildItem $_)) { return } Remove-Item $_ }"
    ],
    "bin": "bin\\qrencode.exe",
    "checkver": {
        "script": [
            "$base_url = 'https://packages.msys2.org/base/'",
            "$version_regex = \"Version:</dt>\\s*<dd[^>]*>([\\d.\\w-]+)\"",
            "",
            "$qrencode_page = (Invoke-WebRequest \"${base_url}mingw-w64-qrencode\" -UseBasicParsing).Content",
            "$libwinpthread_page = (Invoke-WebRequest \"${base_url}mingw-w64-winpthreads-git\" -UseBasicParsing).Content",
            "$libpng_page = (Invoke-WebRequest \"${base_url}mingw-w64-libpng\" -UseBasicParsing).Content",
            "$zlib_page = (Invoke-WebRequest \"${base_url}mingw-w64-zlib\" -UseBasicParsing).Content",
            "",
            "if(!($qrencode_page -match $version_regex)) { error \"No match found for version\"; continue }",
            "$qrencode_version = $matches[1]",
            "if(!($libwinpthread_page -match $version_regex)) { error \"No match found for version\"; continue }",
            "$libwinpthread_version = $matches[1]",
            "if(!($libpng_page -match $version_regex)) { error \"No match found for version\"; continue }",
            "$libpng_version = $matches[1]",
            "if(!($zlib_page -match $version_regex)) { error \"No match found for version\"; continue }",
            "$zlib_version = $matches[1]",
            "",
            "$composite_version = \"${qrencode_version}_${libwinpthread_version}_${libpng_version}_${zlib_version}\"",
            "Write-Output $composite_version"
        ],
        "regex": "(?<version>(?<qrencode>[\\d.-]+)_(?<libwinpthread>[\\d.\\w-]+)_(?<libpng>[\\d.-]+)_(?<zlib>[\\d.-]+))"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": [
                    "https://mirror.msys2.org/mingw/mingw64/mingw-w64-x86_64-qrencode-$matchQrencode-any.pkg.tar.zst",
                    "https://mirror.msys2.org/mingw/mingw64/mingw-w64-x86_64-libwinpthread-git-$matchLibwinpthread-any.pkg.tar.zst",
                    "https://mirror.msys2.org/mingw/mingw64/mingw-w64-x86_64-libpng-$matchLibpng-any.pkg.tar.zst",
                    "https://mirror.msys2.org/mingw/mingw64/mingw-w64-x86_64-zlib-$matchZlib-any.pkg.tar.zst"
                ],
                "hash": [
                    {
                        "url": "https://packages.msys2.org/package/mingw-w64-x86_64-qrencode",
                        "regex": "SHA256:.*\\s+.*<code>($sha256)</code>"
                    },
                    {
                        "url": "https://packages.msys2.org/package/mingw-w64-x86_64-libwinpthread-git",
                        "regex": "SHA256:.*\\s+.*<code>($sha256)</code>"
                    },
                    {
                        "url": "https://packages.msys2.org/package/mingw-w64-x86_64-libpng",
                        "regex": "SHA256:.*\\s+.*<code>($sha256)</code>"
                    },
                    {
                        "url": "https://packages.msys2.org/package/mingw-w64-x86_64-zlib",
                        "regex": "SHA256:.*\\s+.*<code>($sha256)</code>"
                    }
                ]
            },
            "32bit": {
                "url": [
                    "https://mirror.msys2.org/mingw/mingw32/mingw-w64-i686-qrencode-$matchQrencode-any.pkg.tar.zst",
                    "https://mirror.msys2.org/mingw/mingw32/mingw-w64-i686-libwinpthread-git-$matchLibwinpthread-any.pkg.tar.zst",
                    "https://mirror.msys2.org/mingw/mingw32/mingw-w64-i686-libpng-$matchLibpng-any.pkg.tar.zst",
                    "https://mirror.msys2.org/mingw/mingw32/mingw-w64-i686-zlib-$matchZlib-any.pkg.tar.zst"
                ],
                "hash": [
                    {
                        "url": "https://packages.msys2.org/package/mingw-w64-i686-qrencode",
                        "regex": "SHA256:.*\\s+.*<code>($sha256)</code>"
                    },
                    {
                        "url": "https://packages.msys2.org/package/mingw-w64-i686-libwinpthread-git",
                        "regex": "SHA256:.*\\s+.*<code>($sha256)</code>"
                    },
                    {
                        "url": "https://packages.msys2.org/package/mingw-w64-i686-libpng",
                        "regex": "SHA256:.*\\s+.*<code>($sha256)</code>"
                    },
                    {
                        "url": "https://packages.msys2.org/package/mingw-w64-i686-zlib",
                        "regex": "SHA256:.*\\s+.*<code>($sha256)</code>"
                    }
                ]
            }
        }
    }
}
